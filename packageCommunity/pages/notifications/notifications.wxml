<!--packageCommunity/pages/notifications/notifications.wxml-->
<view class="container">
  <!-- 顶部导航栏 -->
  <view class="navbar">
    <view class="navbar-title">通知</view>
    <view class="navbar-action" bindtap="markAllAsRead" wx:if="{{unreadCount > 0}}">
      全部已读
    </view>
  </view>
  
  <!-- 加载状态 -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
  
  <!-- 通知列表 -->
  <view class="notification-list" wx:if="{{!loading && notifications.length > 0}}">
    <view class="notification-item {{item.isRead ? '' : 'unread'}}" 
          wx:for="{{notifications}}" 
          wx:key="id"
          bindtap="viewNotification"
          data-id="{{item.id}}"
          data-index="{{index}}"
          data-type="{{item.type}}"
          data-target-id="{{item.targetId}}"
          data-target-type="{{item.targetType}}">
      <!-- 未读标记 -->
      <view class="unread-dot" wx:if="{{!item.isRead}}"></view>
      
      <!-- 通知图标 -->
      <view class="notification-icon {{item.type}}">
        <block wx:if="{{item.type === 'system'}}">
          <text class="iconfont icon-system"></text>
        </block>
        <block wx:elif="{{item.sender}}">
          <image class="sender-avatar" src="{{item.sender.avatar}}" mode="aspectFill"></image>
        </block>
      </view>
      
      <!-- 通知内容 -->
      <view class="notification-content">
        <view class="notification-text">{{item.content}}</view>
        <view class="notification-time">{{item.createdAt}}</view>
      </view>
      
      <!-- 删除按钮 -->
      <view class="notification-delete" catchtap="deleteNotification" data-id="{{item.id}}" data-index="{{index}}">
        <text class="iconfont icon-delete"></text>
      </view>
    </view>
  </view>
  
  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!loading && notifications.length === 0}}">
    <image class="empty-icon" src="/images/icons/empty-notification.png" mode="aspectFit"></image>
    <text class="empty-text">暂无通知</text>
    <text class="empty-subtext">当有人对你的动态点赞、评论或有新的系统通知时，会显示在这里</text>
  </view>
  
  <!-- 加载更多 -->
  <view class="loading-more" wx:if="{{loading && notifications.length > 0}}">
    <view class="loading-spinner small"></view>
    <text class="loading-text">加载更多...</text>
  </view>
  
  <!-- 没有更多数据 -->
  <view class="no-more" wx:if="{{!loading && !hasMore && notifications.length > 0}}">
    <text>没有更多通知了</text>
  </view>
</view> 
